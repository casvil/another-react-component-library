import{j as x}from"./jsx-runtime-D_zvdyIk.js";import{r as n,e as J}from"./iframe-BURjgtq8.js";import{c as A}from"./clsx-B-dksMZM.js";import{F as K}from"./FormField-CuZX76Ow.js";import{E as Q}from"./ErrorMessage-B1DJFAfK.js";import{B as U}from"./Button-0Qjm44SM.js";const L=n.createContext(null),W=()=>{const r=n.useContext(L);if(!r)throw new Error("useFormContext must be used within a Form component");return r},X=(r,a)=>{const{errors:u,registerField:s,setFieldValue:m,setFieldError:i,clearFieldError:d,getFieldValue:g,validateField:y,validateOnChange:v,validateOnBlur:b,disabled:E}=W();J.useEffect(()=>{const p={name:r,...a};return s(p)},[r,s,a]);const l=g(r),w=u[r],V=!!w,c=n.useCallback(async p=>{m(r,p),v&&await y(r,p)},[r,m,y,v]),T=n.useCallback(async()=>{b&&await y(r,l)},[r,l,y,b]),h=n.useCallback(p=>{i(r,p)},[r,i]),C=n.useCallback(()=>{d(r)},[r,d]);return{value:l,error:w,hasError:V,disabled:E,setValue:c,setError:h,clearError:C,onBlur:T,fieldProps:{name:r,value:typeof l=="string"?l:"",onChange:p=>c(p.target.value),onBlur:T,disabled:E,"aria-invalid":V}}},M=({children:r,value:a})=>x.jsx(L.Provider,{value:a,children:r});M.__docgenInfo={description:"",methods:[],displayName:"FormProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},value:{required:!0,tsType:{name:"FormContextValue"},description:""}}};const $=n.forwardRef(({name:r,required:a=!1,validate:u,className:s,wrapperClassName:m,...i},d)=>{const{value:g,error:y,hasError:v,fieldProps:b}=X(r,{required:a,validate:u});return x.jsxs("div",{className:A("space-y-1",m),children:[x.jsx(K,{ref:d,...i,...b,value:String(g||""),className:A(v&&"border-red-300 focus:ring-red-500 focus:border-red-300",s),required:a}),v&&y&&x.jsx(Q,{id:`${r}-error`,children:y})]})});$.displayName="FormInput";$.__docgenInfo={description:`FormInput component.
Auto-registering form field that integrates with Form context.
Combines FormField (Label + Input + Tooltip) with automatic error display and validation.`,methods:[],displayName:"FormInput",props:{name:{required:!0,tsType:{name:"string"},description:""},required:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},validate:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: unknown) => string | undefined",signature:{arguments:[{type:{name:"unknown"},name:"value"}],return:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}}},description:""}},composes:["Omit"]};const D=(r,a)=>a.split(".").reduce((u,s)=>u&&typeof u=="object"&&u!==null&&s in u?u[s]:void 0,r),H=(r,a,u)=>{const s=a.split("."),m={...r};let i=m;for(let d=0;d<s.length-1;d++){const g=s[d];(!(g in i)||typeof i[g]!="object"||i[g]===null)&&(i[g]={}),i=i[g]}return i[s[s.length-1]]=u,m};function Y(r){const{onSubmit:a,onValidate:u,onFieldChange:s,onFieldBlur:m,onReset:i,initialValues:d={},isSubmitting:g,disabled:y=!1,resetOnSubmit:v=!1,validateOnBlur:b=!1,validateOnSubmit:E=!0}=r,[l,w]=n.useState(d),[V,c]=n.useState({}),[T,h]=n.useState(!1),C=n.useRef(new Map),p=g||T,O=n.useCallback(e=>(C.current.set(e.name,e),e.defaultValue!==void 0&&D(l,e.name)===void 0&&w(t=>H(t,e.name,e.defaultValue)),()=>{C.current.delete(e.name)}),[l]),P=n.useCallback((e,t)=>{w(o=>{const f=H(o,e,t);return s==null||s(e,t,f),f})},[s]),N=n.useCallback(e=>D(l,e),[l]),q=n.useCallback((e,t)=>{c(o=>({...o,[e]:t}))},[]),S=n.useCallback(e=>{c(t=>{const o={...t};return delete o[e],o})},[]),j=n.useCallback(e=>{c(e)},[]),F=n.useCallback(async(e,t)=>{const o=C.current.get(e);if(!o)return;let f;if(o.required&&(t==null||t==="")&&(f="This field is required"),!f&&o.validate&&t!==void 0&&t!==null&&t!=="")try{f=await o.validate(t)}catch{f="Validation failed"}return f?q(e,f):S(e),f},[q,S]),R=n.useCallback(async()=>{const e={},t=Array.from(C.current.entries()).map(async([o])=>{const f=D(l,o),B=await F(o,f);B&&(e[o]=B)});if(await Promise.all(t),u)try{const o=await u(l);Object.assign(e,o)}catch{e.form="Form validation failed"}return e},[l,u,F]),k=n.useCallback(()=>{w(d),c({}),h(!1),i==null||i(d)},[d,i]),I=n.useCallback(async()=>{if(!(y||p)){h(!0);try{if(E){const t=await R();if(Object.keys(t).length>0){c(t);return}}c({}),await a(l,{reset:k,setErrors:j,setFieldValue:P,getFieldValue:N,setFieldError:q,clearFieldError:S,isSubmitting:!0}),v&&k()}catch(e){e instanceof Error?c({form:e.message}):c({form:"An unexpected error occurred"})}finally{h(!1)}}},[y,p,E,R,a,l,v,k,P,N,q,S,j]),z=n.useCallback((e,t)=>{m==null||m(e,t),b&&F(e,t)},[m,b,F]),_=n.useCallback(()=>{c({}),h(!1),k()},[k]);return{values:l,errors:V,isSubmitting:p,registerField:O,setFieldValue:P,getFieldValue:N,setFieldError:q,clearFieldError:S,setErrors:j,submit:I,reset:k,validateField:F,validateForm:R,handleFieldBlur:z,clearErrors:_}}const Z={vertical:"flex flex-col",horizontal:"flex flex-row flex-wrap items-end",grid:"grid"},ee={sm:{vertical:"gap-3",horizontal:"gap-2",grid:"gap-3"},md:{vertical:"gap-4",horizontal:"gap-3",grid:"gap-4"},lg:{vertical:"gap-6",horizontal:"gap-4",grid:"gap-6"}},G=n.forwardRef(({children:r,layout:a="vertical",spacing:u="md",gridColumns:s=2,className:m,submitButton:i,submitText:d="Submit",loadingText:g="Submitting...",showSubmitButton:y=!0,disabled:v=!1,onSubmit:b,onValidate:E,validateOnChange:l,validateOnBlur:w,validateOnSubmit:V,isSubmitting:c,resetOnSubmit:T,initialValues:h,onFieldChange:C,onFieldBlur:p,onReset:O,...P},N)=>{const S=Y({onSubmit:b,onValidate:E,validateOnBlur:w,validateOnSubmit:V,resetOnSubmit:T,initialValues:h,onFieldChange:C,onFieldBlur:p,onReset:O,isSubmitting:c,disabled:v}),{submit:j,isSubmitting:F,errors:R}=S,k={...S,validateOnChange:l??!1,validateOnBlur:w??!0,disabled:v||F},I=async B=>{B.preventDefault(),await j()},z=Z[a],_=ee[u][a],e=a==="grid"?{gridTemplateColumns:`repeat(${s}, 1fr)`}:void 0,t=A("w-full",z,_,v&&"opacity-60 pointer-events-none",m),o=y&&x.jsx(U,{type:"submit",label:F?g:d,disabled:F||v,variant:"primary",className:a==="horizontal"?"ml-auto":void 0}),f=R.form&&x.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-3",role:"alert","aria-live":"polite",children:R.form});return x.jsx(M,{value:k,children:x.jsxs("form",{ref:N,onSubmit:I,className:t,style:e,noValidate:!0,...P,children:[r,f,i||o]})})});G.displayName="Form";G.__docgenInfo={description:`Form molecule component.
Provides a powerful orchestration layer for form state management, validation, and submission.
Automatically detects and manages form fields while maintaining proper accessibility.
Supports flexible layouts, comprehensive validation, and async operations.`,methods:[],displayName:"Form",props:{onSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:`(
  data: FormData,
  helpers: FormHelpers,
) => void | Promise<void>`,signature:{arguments:[{type:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},name:"data"},{type:{name:"FormHelpers"},name:"helpers"}],return:{name:"union",raw:"void | Promise<void>",elements:[{name:"void"},{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}]}}},description:""},onValidate:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  data: FormData,
) => FormErrors | Promise<FormErrors>`,signature:{arguments:[{type:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},name:"data"}],return:{name:"union",raw:"FormErrors | Promise<FormErrors>",elements:[{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"},{name:"Promise",elements:[{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"}],raw:"Promise<FormErrors>"}]}}},description:""},validateOnChange:{required:!1,tsType:{name:"boolean"},description:""},validateOnBlur:{required:!1,tsType:{name:"boolean"},description:""},validateOnSubmit:{required:!1,tsType:{name:"boolean"},description:""},initialValues:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},isSubmitting:{required:!1,tsType:{name:"boolean"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},resetOnSubmit:{required:!1,tsType:{name:"boolean"},description:""},onFieldChange:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  name: string,
  value: unknown,
  allValues: FormData,
) => void`,signature:{arguments:[{type:{name:"string"},name:"name"},{type:{name:"unknown"},name:"value"},{type:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},name:"allValues"}],return:{name:"void"}}},description:""},onFieldBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"(name: string, value: unknown) => void",signature:{arguments:[{type:{name:"string"},name:"name"},{type:{name:"unknown"},name:"value"}],return:{name:"void"}}},description:""},onReset:{required:!1,tsType:{name:"signature",type:"function",raw:"(initialValues: FormData) => void",signature:{arguments:[{type:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},name:"initialValues"}],return:{name:"void"}}},description:""},layout:{required:!1,tsType:{name:"union",raw:"'vertical' | 'horizontal' | 'grid'",elements:[{name:"literal",value:"'vertical'"},{name:"literal",value:"'horizontal'"},{name:"literal",value:"'grid'"}]},description:"",defaultValue:{value:"'vertical'",computed:!1}},spacing:{required:!1,tsType:{name:"union",raw:"'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"",defaultValue:{value:"'md'",computed:!1}},gridColumns:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"2",computed:!1}},submitButton:{required:!1,tsType:{name:"ReactElement"},description:""},submitText:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Submit'",computed:!1}},loadingText:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'Submitting...'",computed:!1}},showSubmitButton:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},children:{required:!0,tsType:{name:"ReactNode"},description:""}},composes:["Omit"]};export{G as F,$ as a};
